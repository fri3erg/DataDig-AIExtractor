import io

import networkx as nx


class TestLEDA:
    def test_parse_leda(self):
        data = """#header section         \nLEDA.GRAPH \nstring\nint\n-1\n#nodes section\n5 \n|{v1***REMOVED***| \n|{v2***REMOVED***| \n|{v3***REMOVED***| \n|{v4***REMOVED***| \n|{v5***REMOVED***| \n\n#edges section\n7 \n1 2 0 |{4***REMOVED***| \n1 3 0 |{3***REMOVED***| \n2 3 0 |{2***REMOVED***| \n3 4 0 |{3***REMOVED***| \n3 5 0 |{7***REMOVED***| \n4 5 0 |{6***REMOVED***| \n5 1 0 |{foo***REMOVED***|"""
        G = nx.parse_leda(data)
        G = nx.parse_leda(data.split("\n"))
        assert sorted(G.nodes()) == ["v1", "v2", "v3", "v4", "v5"]
        assert sorted(G.edges(data=True)) == [
            ("v1", "v2", {"label": "4"***REMOVED***),
            ("v1", "v3", {"label": "3"***REMOVED***),
            ("v2", "v3", {"label": "2"***REMOVED***),
            ("v3", "v4", {"label": "3"***REMOVED***),
            ("v3", "v5", {"label": "7"***REMOVED***),
            ("v4", "v5", {"label": "6"***REMOVED***),
            ("v5", "v1", {"label": "foo"***REMOVED***),
        ]

    def test_read_LEDA(self):
        fh = io.BytesIO()
        data = """#header section         \nLEDA.GRAPH \nstring\nint\n-1\n#nodes section\n5 \n|{v1***REMOVED***| \n|{v2***REMOVED***| \n|{v3***REMOVED***| \n|{v4***REMOVED***| \n|{v5***REMOVED***| \n\n#edges section\n7 \n1 2 0 |{4***REMOVED***| \n1 3 0 |{3***REMOVED***| \n2 3 0 |{2***REMOVED***| \n3 4 0 |{3***REMOVED***| \n3 5 0 |{7***REMOVED***| \n4 5 0 |{6***REMOVED***| \n5 1 0 |{foo***REMOVED***|"""
        G = nx.parse_leda(data)
        fh.write(data.encode("UTF-8"))
        fh.seek(0)
        Gin = nx.read_leda(fh)
        assert sorted(G.nodes()) == sorted(Gin.nodes())
        assert sorted(G.edges()) == sorted(Gin.edges())
